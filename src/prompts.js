export const GUIDED_PROMPTS = {
  Anger: {
    Irritation: {
      Irritated:
        "Name one overstimulation factor you can reduce today. Request: “I’m feeling irritated and need quieter wind-down time after 8pm. Can we lower volume and dim lights then?”",
      Annoyed:
        "Clarify the friction point and ask for a small change. Request: “I’m annoyed by last-minute changes. Could we agree to lock plans 24 hours in advance?”",
      Agitated:
        "Regulate first, then ask for pace. Request: “I feel agitated and need to slow down. Can we take a 10-minute pause and restart with one step at a time?”",
    },
    Frustration: {
      Frustrated:
        "Name the blocked outcome and negotiate a next clear step. Request: “I’m frustrated and need a clear path. Could we decide the next single deliverable and owner?”",
      Exasperated:
        "Lower complexity + share capacity. Request: “I’m at capacity and need fewer moving parts. Can we defer nonessential items this week?”",
    },
    Jealousy: {
      Jealous:
        "Surface the reassurance you need, then ask for it directly. Request: “I’m feeling jealous and need reassurance. Could we schedule a weekly check-in about us?”",
      Envious:
        "Convert envy into a growth request. Request: “I’m feeling envious and need support building this skill. Could we set up a learning plan together?”",
    },
    Rage: {
      Enraged:
        "Prioritize safety and grounding before dialogue. Request: “I’m overwhelmed and need 20 minutes alone to regulate, then I can talk.”",
      Vengeful:
        "Shift from retaliation to repair. Request: “I want fairness. Could we agree on what repair looks like and put dates to each step?”",
    },
    Resentment: {
      Resentful:
        "Name the pattern and ask for reciprocity. Request: “I feel resentful and need shared load. Can we split this task 50/50 for the next two weeks?”",
      Bitter:
        "Invite acknowledgment + closure. Request: “I’m carrying bitterness and need recognition for my effort and an agreement on boundaries going forward.”",
    },
    Contempt: {
      Disdainful:
        "Re-anchor in dignity and shared humanity. Request: “I’m feeling contempt and need to reset how we speak to each other. Can we use non-blaming language and timeouts when heated?”",
    },
  },

  Fear: {
    Anxiety: {
      Anxious:
        "Ask for clarity + co-regulation. Request: “I’m anxious and need a simple plan. Could we outline three steps and schedule a quick check-in?”",
      Worried:
        "Name uncertainty; ask for information cadence. Request: “I’m worried and need updates. Can we do a brief daily status until this resolves?”",
      Nervous:
        "Ask for prep + rehearsal. Request: “I’m nervous and need to practice. Can we do a 10-minute dry run together?”",
    },
    Apprehension: {
      Apprehensive:
        "Request gentle ramp-up. Request: “I’m apprehensive and need a slower start. Could we begin with a small pilot?”",
      Uneasy:
        "Ask for reassurance + scope. Request: “I’m uneasy and need to know the limits. Can we clarify what’s in vs. out?”",
    },
    Insecurity: {
      Insecure:
        "Ask for explicit reassurance or criteria. Request: “I’m feeling insecure and need clear success markers. Can we define what ‘good’ looks like?”",
      Helpless:
        "Ask for agency in small chunks. Request: “I feel helpless and need a step I own. What’s one part I can lead this week?”",
      Vulnerable:
        "Ask for care + protection agreement. Request: “I’m vulnerable and need gentleness. Can we agree to pause if I say ‘timeout’?”",
    },
    Panic: {
      Panicked:
        "Ground the body first; then ask for containment. Request: “I’m panicked and need a quiet space + slow breaths with you for two minutes.”",
    },
    Terror: {
      Horrified:
        "Acknowledge trauma response; ask for safety anchor. Request: “I’m horrified and need to feel safe. Can we step outside, sit, and orient together?”",
    },
  },

  Sadness: {
    Disappointment: {
      Disappointed:
        "Ask for encouragement + next attempt. Request: “I’m disappointed and need a reset. Could we try again with adjusted expectations?”",
      Regretful:
        "Move toward repair. Request: “I regret how that landed. I need a chance to make amends—what would feel meaningful to you?”",
      Hurt:
        "Ask for care + pacing. Request: “I’m hurt and need gentler tone. Can we slow down and stay with one topic?”",
    },
    Grief: {
      Grieving:
        "Invite shared ritual or witness. Request: “I’m grieving and need presence. Could you sit with me for 10 minutes without fixing?”",
      Heartbroken:
        "Ask for tenderness + continuity. Request: “My heart hurts and I need small acts of care across the week. Can we plan two?”",
    },
    Hopelessness: {
      Hopeless:
        "Borrow hope; ask for one actionable ray. Request: “I feel hopeless and need one achievable step we can do today. What’s your pick?”",
      Despairing:
        "Ask for co-regulation + meaning check. Request: “I’m in despair and need grounding and purpose. Can we review what still matters to me?”",
    },
    Shame: {
      Ashamed:
        "Invite compassion + nonjudgmental reflection. Request: “I feel ashamed and need kindness. Can we talk using curious, not blaming, questions?”",
      Remorseful:
        "Channel remorse into repair steps. Request: “I’m remorseful and need to take responsibility. Can we list repairs and schedule them?”",
    },
    Loneliness: {
      Lonely:
        "Ask directly for contact. Request: “I feel lonely and need connection. Could we plan a call or walk this week?”",
      Isolated:
        "Bridge back to community. Request: “I feel isolated and need gentle re-entry. Can you join me at one event this weekend?”",
    },
  },

  Surprise: {
    Shock: {
      Stunned:
        "Ask for orientation. Request: “I’m stunned and need time to process. Can we recap what just happened and next steps?”",
      Disbelief:
        "Ask for explanation. Request: “I’m in disbelief and need context. Could you walk me through the reasoning and evidence?”",
    },
    Amazement: {
      Amazed:
        "Convert awe into action. Request: “I feel amazed and want to build on this. Can we capture what worked and repeat it next time?”",
    },
  },

  Happiness: {
    Joy: {
      Joyful:
        "Amplify and embed. Request: “I’m joyful and want more of this. Can we schedule a repeat next week?”",
      Excited:
        "Channel momentum. Request: “I’m excited and need a sandbox. Can we carve 90 minutes for focused creation?”",
    },
    Contentment: {
      Relieved:
        "Consolidate safety. Request: “I’m relieved and need closure. Can we confirm what’s done and document learnings?”",
      Serene:
        "Protect the state. Request: “I feel serene and want to preserve this. Can we keep evenings device-free?”",
    },
    Pride: {
      Proud:
        "Share and celebrate. Request: “I’m proud and need acknowledgment. Could we share a quick win note with the team?”",
      Confident:
        "Lean into stewardship. Request: “I’m confident and want to mentor. Can I support someone taking a similar path?”",
    },
  },
};

export const CORE_FALLBACK = {
  Anger:
    "Center the boundary you need. Request: “I’m activated and need a clearer boundary. Can we define limits and consequences?”",
  Fear:
    "Increase predictability. Request: “I’m anxious and need a map. Can we outline steps, owners, and check-ins?”",
  Sadness:
    "Invite care + repair. Request: “I’m hurting and need compassion. Can we slow down and name one repair?”",
  Surprise:
    "Orient, then act. Request: “This surprised me and I need context. Can we review facts and decide one next step?”",
  Happiness:
    "Amplify what’s working. Request: “This feels good and I want more. Can we schedule a repeat and name why it worked?”",
};

export const NEED_FALLBACK = {
  safety:
    "Ask for a safety anchor. Request: “I need to feel safe. Can we take a 10-minute pause and agree on calm-language only?”",
  clarity:
    "Ask for simple structure. Request: “I need clarity. Can we write the next three steps and who owns them?”",
  connection:
    "Ask for contact. Request: “I need connection. Can we plan a check-in call this week?”",
  respect:
    "Ask for dignity rituals. Request: “I need respect. Can we use non-blaming language and avoid interruptions?”",
  rest:
    "Ask for recovery. Request: “I need rest. Can we wrap by 9pm and keep tomorrow morning light?”",
};

export const DEFAULT_PROMPT =
  "Name your need, then translate it into a doable request beginning with “Could we…” and ending with a time or boundary. Keep it small and testable.";

export function guidanceFor({ core, sub, specific, needs = [] }) {
  if (GUIDED_PROMPTS?.[core]?.[sub]?.[specific]) {
    return GUIDED_PROMPTS[core][sub][specific];
  }
  if (GUIDED_PROMPTS?.[core]?.[sub]) {
    const first = Object.values(GUIDED_PROMPTS[core][sub])[0];
    if (first) return first;
  }
  if (CORE_FALLBACK?.[core]) return CORE_FALLBACK[core];
  const flat = needs.map(n => n.toLowerCase());
  for (const [k,v] of Object.entries(NEED_FALLBACK)) {
    if (flat.some(n => n.includes(k))) return v;
  }
  return DEFAULT_PROMPT;
}